# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç MATH-AGENT-VL

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —ç—Ç–∞–ª–æ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–∞–π–ø–ª–∞–π–Ω–∞ **–í–∏–∑—É–∞–ª—å–Ω–æ-–Ø–∑—ã–∫–æ–≤–æ–≥–æ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ê–≥–µ–Ω—Ç–∞ (Vision-Language Math Agent)**. –û–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã—Ö –∑–∞–¥–∞—á –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É –∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ, —Å–æ—á–µ—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Tree of Thoughts) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (ReAct).

## üß† –û—Å–Ω–æ–≤–Ω–æ–π –ü–∞–π–ø–ª–∞–π–Ω (Core Pipeline)

–ê–≥–µ–Ω—Ç —Å–ª–µ–¥—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–º—É —á–µ—Ç—ã—Ä–µ—Ö—ç—Ç–∞–ø–Ω–æ–º—É –ø–∞–π–ø–ª–∞–π–Ω—É, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –≤ `main.py`:

```mermaid
graph LR
    Input[–í—Ö–æ–¥–Ω–∞—è –ó–∞–¥–∞—á–∞] --> Formalizer[–§–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä]
    Formalizer --> Planner[ToT –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫]
    Planner --> Executor[ReAct –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å]
    Executor --> Verifier[–í–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä & –ö—Ä–∏—Ç–∏–∫]
    Verifier --> Output[–§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç–≤–µ—Ç]
```

### 1. –í—Ö–æ–¥–Ω–æ–π –§–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä (Input Formalizer)
*   **–¶–µ–ª—å**: –ü–æ–Ω—è—Ç—å –∑–∞–¥–∞—á—É.
*   **–ü—Ä–æ—Ü–µ—Å—Å**: –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç `ProblemObject`.
*   **–ú–µ—Ç–æ–¥**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–≤—Ä–∏—Å—Ç–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π (regex) –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö/—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–¥–∞—á, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ Gemini –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Å—É—â–Ω–æ—Å—Ç–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ü–µ–ª–∏.

### 2. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ "–î–µ—Ä–µ–≤–æ –ú—ã—Å–ª–µ–π" (Tree-of-Thought Planner)
*   **–¶–µ–ª—å**: –†–µ—à–∏—Ç—å, *–∫–∞–∫* —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø—ã—Ç–∞—Ç—å—Å—è —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å.
*   **–ü—Ä–æ—Ü–µ—Å—Å**: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤-–ø–ª–∞–Ω–æ–≤ (**Plans**).
*   **–ú–µ—Ç–æ–¥**:
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç LLM (Gemini) –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è 2-3 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é Python" –ø—Ä–æ—Ç–∏–≤ "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–º–≤–æ–ª—å–Ω—É—é –∞–ª–≥–µ–±—Ä—É").
    *   –ö–∞–∂–¥—ã–π –ø–ª–∞–Ω –∏–º–µ–µ—Ç `heuristic_score` (—ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫—É—é –æ—Ü–µ–Ω–∫—É) –∏ —Å–ø–∏—Å–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`estimated_tooling`).
    *   –õ—É—á—à–∏–π –ø–ª–∞–Ω –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ª–∏–±–æ LLM, –ª–∏–±–æ –ø–æ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–µ.

### 3. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å ReAct (ReAct Executor)
*   **–¶–µ–ª—å**: –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–ª–∞–Ω —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.
*   **–ü—Ä–æ—Ü–µ—Å—Å**: –ü—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —à–∞–≥–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –ø–ª–∞–Ω–µ.
*   **–ú–µ—Ç–æ–¥**:
    *   **–†–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ (Reason)**: –ê–≥–µ–Ω—Ç –æ–±–¥—É–º—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
    *   **–î–µ–π—Å—Ç–≤–∏–µ (Act)**: –í—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (Action).
    *   **–ù–∞–±–ª—é–¥–µ–Ω–∏–µ (Observe)**: –ß–∏—Ç–∞–µ—Ç –≤—ã–≤–æ–¥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.
*   **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**:
    *   `python`: –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å Python (PAL - Program Aided Language models).
    *   `sympy`: –°–∏–º–≤–æ–ª—å–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
    *   `wolfram`: (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ—Å—Ç—É–ø –∫ WolframAlpha –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–Ω–∞–Ω–∏–π.
    *   `gemini`: –û–±—â–µ–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑.

### 4. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏ –ö—Ä–∏—Ç–∏–∫ (Verifier & Critic)
*   **–¶–µ–ª—å**: –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å.
*   **–ü—Ä–æ—Ü–µ—Å—Å**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç—Ä–∞—Å—Å—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (execution trace).
*   **–ú–µ—Ç–æ–¥**: –ú–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Ü–∏–∫–ª—ã —Å–∞–º–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏, –µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω—ã–º –∏–ª–∏ –µ—Å–ª–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —à–∞–≥–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –Ω–µ—É–¥–∞—á–µ–π.

## üõ† –ö–ª—é—á–µ–≤—ã–µ –ö–ª–∞—Å—Å—ã

*   `ProblemObject`: –î–∞—Ç–∞–∫–ª–∞—Å—Å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏.
*   `Plan`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é —à–∞–≥–æ–≤.
*   `ExecutionStep`: –ï–¥–∏–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç—ã –≤ —Ü–∏–∫–ª–µ ReAct (–ú—ã—Å–ª—å -> –î–µ–π—Å—Ç–≤–∏–µ -> –ù–∞–±–ª—é–¥–µ–Ω–∏–µ).
*   `PythonSandbox`: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ Python.
*   `GeminiClient` / `WolframClient`: –û–±–µ—Ä—Ç–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API.

## üöÄ –§–∏–ª–æ—Å–æ—Ñ–∏—è –î–∏–∑–∞–π–Ω–∞

–≠—Ç–æ—Ç –∞–≥–µ–Ω—Ç —Å—Ç–∞–≤–∏—Ç **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—à–µ –£–≥–∞–¥—ã–≤–∞–Ω–∏—è**. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å, –æ–Ω —Å–Ω–∞—á–∞–ª–∞:
1.  **–§–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç** –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
2.  **–ü–ª–∞–Ω–∏—Ä—É–µ—Ç** –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤.
3.  **–í—ã–±–∏—Ä–∞–µ—Ç** –ª—É—á—à–∏–π –ø–æ–¥—Ö–æ–¥.
4.  **–í—ã–ø–æ–ª–Ω—è–µ—Ç** –µ–≥–æ —Å–æ —Å—Ç—Ä–æ–≥–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

–¢–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏, —Ç—Ä–µ–±—É—é—â–∏–º–∏ —Å–æ—á–µ—Ç–∞–Ω–∏—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏, —Å–∏–º–≤–æ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∏ –æ–±—â–µ–≥–æ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è.
